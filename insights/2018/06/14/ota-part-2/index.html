<!doctype html>
<html class="no-js" lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>What Is OTA Connect | Foundries.io</title>

  <link rel="shortcut icon" href="https://foundries.io/images/icons/favicon.ico" />
  <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css' />
  <link rel="stylesheet" href="https://foundries.io/css/foundation.css" />
  <link rel="stylesheet" href="https://foundries.io/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://foundries.io/css/animate.min.css" />
  <link rel="stylesheet" href="https://foundries.io/css/morphext.css" />
  <link rel="stylesheet" href="https://foundries.io/css/owl.carousel.css" />
  <link rel="stylesheet" href="https://foundries.io/css/owl.theme.css" />
  <link rel="stylesheet" href="https://foundries.io/css/owl.transitions.css" />
  <link rel="stylesheet" href="https://foundries.io/css/slicknav.css" />
  <link rel="stylesheet" href="https://foundries.io/style.css" />
  <link rel="stylesheet" href="https://foundries.io/css/style.default.css" />
  <link rel="stylesheet" href="https://foundries.io/css/style.insights.css" />

</head>


<body>
    
<div class="top sticky">
    <div class="row">
        <div class="small-12 large-3 medium-3 columns">
            <div class="logo">
                <a href="https://foundries.io/" title="">
                    <img src="https://foundries.io/images/logo.png" alt="Foundries.io logo"/>
                </a>
            </div>
        </div>

        <div class="small-12 large-9 medium-9 columns">

            <nav class="desktop-menu">
                <ul class="sf-menu" id="navigation">
                    <li>
                        <a href="https://foundries.io/">HOME</a>
                    </li>
                    <li>
                        <a href="https://foundries.io/products/">
                            PRODUCTS
                        </a>
                        <ul class="nav-products">
                            <li><a href="https://foundries.io/products/">MICROPLATFORMS</a></li>
                            <li><a href="https://foundries.io/pricing/">PRICING</a></li>
                            <li><a href="https://foundries.io/hardware/">HARDWARE</a></li>
                        </ul>
                    </li>

                    <li>
                        <a href="https://foundries.io/partners/">PARTNERS</a>
                    </li>
                    <li>
                        <a href="https://foundries.io/insights/">INSIGHTS</a>
                        <ul class="nav-products">
                            <li><a href="https://foundries.io/insights/">BLOG</a></li>
                            <li><a href="https://foundries.io/categories/updates/">UPDATES</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="https://foundries.io/company/">ABOUT</a>
                        <ul class="nav-about">
                            <li>
                                <a href="https://foundries.io/company/">COMPANY</a>
                            </li>
                            <li>
                                <a href="https://foundries.io/labs/">LABS</a>
                            </li>
                            <li>
                                <a href="https://foundries.io/careers/">CAREERS</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="https://app.foundries.io/login/?next=/">
                            <i class="fa fa-cloud-upload"></i>&nbsp;ENGAGE
                        </a>
                        <ul class="nav-engage">
                            <li>
                                <a href="https://app.foundries.io/docs/">
                                    DOCUMENTATION
                                </a>
                            </li>
                            <li>
                                <a href="https://app.foundries.io/login/?next=/">
                                    DASHBOARD
                                </a>
                            </li>
                            <li>
                                <a href="https://forums.foundries.io">FORUMS</a>
                            </li>
                            <li>
                                <a href="https://support.foundries.io">SUPPORT</a>
                            </li>
                            <li>
                                <a href="https://join.slack.com/t/foundriesio/shared_invite/enQtMjUwNzA1MTc4NzA4LTI2YTc4YjUyMTY2NWE3NTQxOTJjYjY3M2NkNTVmYjM2M2JhZGYzNDM1Mzk4MzkxMDI5ZWNhOWUzMWVlYmI4NDE">
                                    SLACK
                                </a>
                            </li>
                            <li>
                                <a href="https://app.foundries.io/login/?next=/">
                                    GET STARTED
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
            
        </div>
    </div>
</div>



    
    <header class="alt-6">
        <div class="message">
            <div class="row">
                <div class="small-12 columns">
                    <div class="message-intro">
                        <span class="message-line"></span>
                        <p>FOUNDRIES.IO INSIGHTS</p>
                        <span class="message-line"></span>
                    </div>
                    <h1>What Is OTA Connect</h1>
                    <p class="text-muted text-uppercase mb-small text-right color-white">
                        
                        June 14, 2018
                    </p>
                </div>
            </div>
        </div>
    </header>
    

    <div id="content">
        <div class="container">

            <div class="row">

                

                <div class="small-12 columns" id="insights-post">

                    <div id="post-content">
                        <p>Continuing with the <a href="https://foundries.io/insights/2018/05/25/ota-part-1/">OTA blog series</a>, this article will explain what <a href="https://github.com/advancedtelematic/ota-community-edition">OTA Connect</a> is and how it implements the TUF/Uptane/OSTree specifications.
</p>

<p>OTA Connect is open-source server software that supports devices compatible with <a href="https://github.com/advancedtelematic/aktualizr/">Aktualizr</a>. It has a micro-service architecture that&rsquo;s designed to be deployed inside Kubernetes. This article will explain the main micro-services, how they are related, and how easy they&rsquo;d be to replace with another implementation. The services described are:</p>

<ul>
<li><a href="https://github.com/advancedtelematic/treehub">TreeHub</a></li>
<li><a href="https://github.com/advancedtelematic/ota-tuf/tree/master/reposerver">Repo Server</a></li>
<li><a href="https://github.com/advancedtelematic/director">Director</a></li>
<li><a href="https://github.com/advancedtelematic/ota-device-registry/">Device Registry</a></li>
<li><a href="https://github.com/advancedtelematic/ota-plus-server">OTA+ Web</a></li>
<li>Gateway</li>
</ul>

<p>Take a look at <a href="https://foundries.io/insights/2018/05/25/ota-part-1/">part 1</a> of this blog series if you&rsquo;d like a little more background on TUF and Uptane.</p>

<h3 id="treehub">TreeHub</h3>

<p>The TreeHub is the easiest component to understand. It mostly operates like a web server handling static content. The server is responsible for returning the contents of objects request by a client. The default configuration deployed by OTA Community Edition uses a persistent storage volume. This means only one copy of the service can run and is thus a single point of failure. However, it also has support for <a href="https://github.com/advancedtelematic/treehub/blob/master/src/main/scala/com/advancedtelematic/treehub/object_store/S3BlobStore.scala">S3</a> and could be configured to use S3 or a Google Storage Bucket in an HA friendly manner.</p>

<p>This server has no built-in HTTP security. If it&rsquo;s exposed publicly, anyone can push OSTree images to it. In order to host this securely, you&rsquo;ll want to put a reverse HTTP proxy in front of it. The garage-push tool supports three forms of authentication: <a href="https://github.com/advancedtelematic/aktualizr/blob/master/src/sota_tools/authenticate.cc">HTTP Basic, OAuth2, and SSL client certs</a>. So any server that honors those options will work seamlessly.</p>

<p><strong><em>Replaceability SWAG</em></strong>: <em>Medium</em> - Most OSTree implementations are geared for static HTTP hosting on a single system or servers rsynced with each other. It wouldn&rsquo;t be too hard to write your own Kubernetes friendly web service that could do this.</p>

<h3 id="repo-server">Repo Server</h3>

<p>The Repo Server is part of the <a href="https://github.com/advancedtelematic/ota-tuf/">OTA-TUF project</a> and handles TUF metadata files that describe the contents of the TreeHub. In terms of the Foundries.io Linux microPlatform, this means it&rsquo;s responsible for securely providing a list of known <a href="https://api.foundries.io/lmp/repo/release/api/v1/user_repo/targets.json">good images</a>. This service is stateless and can be scaled out horizontally to provide high availability.</p>

<p>The security model is almost identical to TreeHub. In fact the garage-sign tool that interacts with the Repo Server uses the same credentials.zip used by garage-push. There is one <a href="https://github.com/advancedtelematic/ota-tuf/issues/162">notable difference</a> in that garage-sign does not have support for HTTP Basic authentication.</p>

<p><strong><em>Replaceability SWAG</em></strong>: <em>Hard</em> - There&rsquo;s the <a href="https://github.com/theupdateframework/tuf">TUF reference</a> project could probably be extended, but their on-disk format is slightly different and cryptography is never easy.</p>

<h3 id="director">Director</h3>

<p>The Director implements the server side Uptane logic. It uses online keys to sign metadata that tells the device (Aktualizr) what image from the Repo Server it should be running. The /var/sota/metadata/director/targets.json is generated from the Director. This service is stateless and can be scaled out horizontally to provide high availability.</p>

<p>The Director sits behind the Gateway service so it doesn&rsquo;t require any built-in authentication logic.</p>

<p><strong><em>Replaceability SWAG</em></strong>: <em>Hard</em> - The <a href="https://github.com/uptane/uptane/">Uptane reference implementation</a> would be a good starting point, but Uptane is complex.</p>

<h3 id="device-registry">Device Registry</h3>

<p>The Device Registry handles the management of device status and configuration information. Aktualizr reports packages installed, hardware and IP information, and the results of <code>lshw</code> to the registry. This service is stateless and can be scaled out horizontally to provide high availability.</p>

<p>The Device Registry sits behind the Gateway service so it doesn&rsquo;t require any built-in authentication logic.</p>

<p><strong><em>Replaceability SWAG</em></strong>: <em>Medium</em> - There&rsquo;s nothing quite like it to start from, but mostly it&rsquo;s an effort of mapping REST API calls to a database.</p>

<h3 id="ota-web">OTA+ Web</h3>

<p>OTA+ Web provides a web front-end to the OTA Connect components. The web interface shows information about devices and images and allows a user to update a device. This service is stateless and can be scaled out horizontally to provide high availability.</p>

<p>The default configuration supports no authentication and is single-user only. However, there are a few <a href="https://github.com/advancedtelematic/ota-plus-server#authentication">authentication options</a>.</p>

<p><strong><em>Replaceability SWAG</em></strong>: <em>Easy/Medium</em> - It depends on how fancy the UI should be. Foundries.io implemented its own custom interface in less than a week that suited our specific needs.</p>

<h3 id="gateway">Gateway</h3>

<p>The Gateway isn&rsquo;t really a component, but implements an NGINX reverse proxy that authenticates requests from Aktualizr and routes them to the proper internal micro-service. The service is stateless and is connected to a publicly exposed Kubernetes load balancer service.</p>

<p>This service uses SSL client <a href="https://github.com/advancedtelematic/ota-community-edition/blob/master/scripts/start.sh#L109">certificates</a> to authenticate all incoming traffic.</p>

<p><strong><em>Replaceability SWAG</em></strong>: <em>Easy</em> - You basically customize this to suite your <a href="https://github.com/foundriesio/ota-community-edition/commit/f6b80d34b46001f25ed68f7d89e49dc835e0d612">deployment needs</a>.</p>

<h2 id="putting-it-all-together">Putting It All Together</h2>

<p>The Gateway and OTA+ Web are responsible for securely proxying requests from devices and the browser to the Device Registry, Director, Repo Server, and TreeHub. The garage-push and garage-sign tools used by OE builds require access to the TreeHub and Repo Server respectively. These have no built-in authentication, so a custom proxy must be created if you want to host these securely on the Internet.</p>

<pre><code>     +-----+  +-----+       +---------+    +-------------+ +-------------+
     |     |  |     |       |         |    |             | |             |
     | LMP |  | LMP |       | Browser |    | garage-push | | garage-sign |
     |     |  |     |       |         |    |             | |             |
     +---+-+  +-+---+       +---+-----+    +----+--------+ +---+---------+
         |      |               |               |              |
    +----|------|---------------|---------------|--------------|---+
    |    |      |  Internet     |               |              |   |
    +----|------|---------------|---------------|--------------|---+
         |      |               |               |              |
+--------|------|---------------|---------------|--------------|---------+
|        |      |               |               |              |         |
|        |      |               |               |              |         |
|        |      |               |             +-v--------------v------+  |
|      +-v------v----+     +----v---------+   |                       |  |
|      |             |     |              |   | Your Custom Proxy to  |  |
|      |   Gateway   |     |   OTA+ Web   |   | TreeHub / Repo Server |  |
|      |             |     |              |   |                       |  |
|      +-------------+     +--------------+   +-----------------------+  |
|                                                                        |
|                                                                        |
|  +----------+   +----------+         +-------------+   +---------+     |
|  |          |   |          |         |             |   |         |     |
|  | Registry |   | Director |         | Repo Server |   | TreeHub |     |
|  |          |   |          |         |             |   |         |     |
|  +----------+   +----------+         +-------------+   +---------+     |
|                                                                        |
|        Kubernetes                                                      |
+------------------------------------------------------------------------+
</code></pre>
                    </div>
                    
                    
                    <div id="comments">
                        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "foundriesio" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    </div>
                    

                </div>

            </div>

            <div class="row">
                

                

                

                <div class="small-12 columns">

                    <div class="post-categories">
                        

                        







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            <li><a href="https://foundries.io/categories/blockchain">blockchain (1)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/conferences">conferences (3)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/demos">demos (1)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/fota">fota (8)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/microplatform">microplatform (4)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/microplatforms">microplatforms (1)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/mp-containers">mp-containers (5)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/news-and-media">news-and-media (2)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/updates">updates (36)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/zephyr-mp">zephyr-mp (2)</a>
            </li>
            
            <li><a href="https://foundries.io/categories/zephyr-news">zephyr-news (16)</a>
            </li>
            
        </ul>
    </div>
</div>








<div class="panel sidebar-menu">
    <div class="panel-heading">
        <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            <li><a href="https://foundries.io/tags/assistant"><i class="fa fa-tags"></i> assistant</a>
            </li>
            
            <li><a href="https://foundries.io/tags/att"><i class="fa fa-tags"></i> att</a>
            </li>
            
            <li><a href="https://foundries.io/tags/ble"><i class="fa fa-tags"></i> ble</a>
            </li>
            
            <li><a href="https://foundries.io/tags/blockchain"><i class="fa fa-tags"></i> blockchain</a>
            </li>
            
            <li><a href="https://foundries.io/tags/bugs"><i class="fa fa-tags"></i> bugs</a>
            </li>
            
            <li><a href="https://foundries.io/tags/containers"><i class="fa fa-tags"></i> containers</a>
            </li>
            
            <li><a href="https://foundries.io/tags/crypto"><i class="fa fa-tags"></i> crypto</a>
            </li>
            
            <li><a href="https://foundries.io/tags/cve"><i class="fa fa-tags"></i> cve</a>
            </li>
            
            <li><a href="https://foundries.io/tags/decentralized"><i class="fa fa-tags"></i> decentralized</a>
            </li>
            
            <li><a href="https://foundries.io/tags/demos"><i class="fa fa-tags"></i> demos</a>
            </li>
            
            <li><a href="https://foundries.io/tags/docker"><i class="fa fa-tags"></i> docker</a>
            </li>
            
            <li><a href="https://foundries.io/tags/docker-compose"><i class="fa fa-tags"></i> docker-compose</a>
            </li>
            
            <li><a href="https://foundries.io/tags/fota"><i class="fa fa-tags"></i> fota</a>
            </li>
            
            <li><a href="https://foundries.io/tags/foundries.io"><i class="fa fa-tags"></i> foundries.io</a>
            </li>
            
            <li><a href="https://foundries.io/tags/google"><i class="fa fa-tags"></i> google</a>
            </li>
            
            <li><a href="https://foundries.io/tags/iot"><i class="fa fa-tags"></i> iot</a>
            </li>
            
            <li><a href="https://foundries.io/tags/k8s"><i class="fa fa-tags"></i> k8s</a>
            </li>
            
            <li><a href="https://foundries.io/tags/keys"><i class="fa fa-tags"></i> keys</a>
            </li>
            
            <li><a href="https://foundries.io/tags/kubernetes"><i class="fa fa-tags"></i> kubernetes</a>
            </li>
            
            <li><a href="https://foundries.io/tags/linux"><i class="fa fa-tags"></i> linux</a>
            </li>
            
            <li><a href="https://foundries.io/tags/lte"><i class="fa fa-tags"></i> lte</a>
            </li>
            
            <li><a href="https://foundries.io/tags/lwm2m"><i class="fa fa-tags"></i> lwm2m</a>
            </li>
            
            <li><a href="https://foundries.io/tags/management"><i class="fa fa-tags"></i> management</a>
            </li>
            
            <li><a href="https://foundries.io/tags/mcuboot"><i class="fa fa-tags"></i> mcuboot</a>
            </li>
            
            <li><a href="https://foundries.io/tags/media"><i class="fa fa-tags"></i> media</a>
            </li>
            
            <li><a href="https://foundries.io/tags/microplatform"><i class="fa fa-tags"></i> microplatform</a>
            </li>
            
            <li><a href="https://foundries.io/tags/open-source"><i class="fa fa-tags"></i> open-source</a>
            </li>
            
            <li><a href="https://foundries.io/tags/ota"><i class="fa fa-tags"></i> ota</a>
            </li>
            
            <li><a href="https://foundries.io/tags/portainer"><i class="fa fa-tags"></i> portainer</a>
            </li>
            
            <li><a href="https://foundries.io/tags/press"><i class="fa fa-tags"></i> press</a>
            </li>
            
            <li><a href="https://foundries.io/tags/radio"><i class="fa fa-tags"></i> radio</a>
            </li>
            
            <li><a href="https://foundries.io/tags/resin"><i class="fa fa-tags"></i> resin</a>
            </li>
            
            <li><a href="https://foundries.io/tags/security"><i class="fa fa-tags"></i> security</a>
            </li>
            
            <li><a href="https://foundries.io/tags/update"><i class="fa fa-tags"></i> update</a>
            </li>
            
            <li><a href="https://foundries.io/tags/whitepaper"><i class="fa fa-tags"></i> whitepaper</a>
            </li>
            
            <li><a href="https://foundries.io/tags/zephyr"><i class="fa fa-tags"></i> zephyr</a>
            </li>
            
            <li><a href="https://foundries.io/tags/zmp"><i class="fa fa-tags"></i> zmp</a>
            </li>
            
        </ul>
    </div>
</div>






                        
                    </div>

                </div>
                

                

            </div>
            

        </div>
        
    </div>
    

    
<footer>
    <div class="row">
        <div class="small-12 columns">
            <div class="contacts">
                <div class="row">
                    <div class="small-12 large-6 medium-6 columns">
                        <i class="fa fa-map-marker"></i>
                        CAMBRIDGE, UK
                    </div>
                    <div class="small-12 large-6 medium-6 columns">
                        <i class="fa fa-map-marker"></i>
                        SEATTLE, WA USA
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="small-12 columns">
            <div class="footerlinks" data-equalizer>
                <div class="small-12 large-3 medium-3 columns border-right" data-equalizer-watch>
                    <h2>About Foundries.io</h2>
                    <p>
                        Foundries.io is changing the IoT landscape by delivering continuously
                        updated software platforms for a secure, connected world.
                    </p>
                </div>

                <div class="small-12 large-3 medium-3 columns border-right" data-equalizer-watch>
                    <h2>Company</h2>
                    <ul>
                        <li><a href="https://foundries.io/company/">About</a></li>
                        <li><a href="https://foundries.io/careers/">Careers</a></li>
                        <li><a href="https://support.foundries.io/">Support</a></li>
                        <li><a href="https://foundries.io/labs/">Labs</a></li>
                    </ul>
                </div>

                <div class="small-12 large-3 medium-3 columns border-right" data-equalizer-watch>
                    <h2>Connect</h2>
                    <ul class="social-links">
                        <li>
                            <a href="https://twitter.com/foundriesio">
                                <i class="fa fa-twitter fa-2x"></i>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.facebook.com/foundriesio">
                                <i class="fa fa-facebook fa-2x"></i>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/foundriesio">
                                <i class="fa fa-github fa-2x"></i>
                            </a>
                        </li>
                        <li>
                            <a href="https://foundriesio.slack.com/join/shared_invite/enQtMjUwNzA1MTc4NzA4LTI2YTc4YjUyMTY2NWE3NTQxOTJjYjY3M2NkNTVmYjM2M2JhZGYzNDM1Mzk4MzkxMDI5ZWNhOWUzMWVlYmI4NDE">
                                <i class="fa fa-slack fa-2x"></i>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="small-12 large-3 medium-3 columns" data-equalizer-watch>
                    <h2>Get Started Today</h2>
                    <p>
                        Get immediate access to microPlatform source and binary builds for
                        today's most popular development boards by starting your evaluation subscription.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <p class="copyright">Copyright 2018 Foundries.io All rights reserved</p>
</footer>



    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-111281311-1', 'auto');
ga('send', 'pageview');
</script>

<script src="https://foundries.io/js/vendor/jquery.js"></script>
<script src="https://foundries.io/js/vendor/what-input.min.js"></script>
<script src="https://foundries.io/js/foundation.min.js"></script>
<script src="https://foundries.io/js/vendor/hoverIntent.js"></script>
<script src="https://foundries.io/js/vendor/superfish.min.js"></script>
<script src="https://foundries.io/js/vendor/morphext.min.js"></script>
<script src="https://foundries.io/js/vendor/wow.min.js"></script>
<script src="https://foundries.io/js/vendor/jquery.slicknav.min.js"></script>
<script src="https://foundries.io/js/vendor/waypoints.min.js"></script>
<script src="https://foundries.io/js/vendor/jquery.animateNumber.min.js"></script>
<script src="https://foundries.io/js/vendor/owl.carousel.min.js"></script>
<script src="https://foundries.io/js/vendor/jquery.responsiveTabs.js"></script>
<script src="https://foundries.io/js/custom.js"></script>
<script>
jQuery(function($) {
    
    $('#responsiveTabsDemo').responsiveTabs({
    startCollapsed: 'accordion'
    });
});
</script>


</body>
</html>
